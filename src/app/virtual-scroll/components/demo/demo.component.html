<ng-container *ngIf="photos$ | async as photos">
  <cdk-virtual-scroll-viewport
    itemSize="100"
    (scrolledIndexChange)="nextBatch($event, photos.length)"
  >
    <div
      *cdkVirtualFor="let photo of photos; let i = index; trackBy: trackByIdx"
      class="d-flex photo animate__animated animate__lightSpeedInRight"
    >
      <div class="flex-shrink-0">
        <img [src]="photo.thumbnailUrl" alt="photo.title" class="img-fluid" />
      </div>
      <div class="flex-grow-1 ms-3">
        <h4>{{ i }}. {{ photo.title }}</h4>
        <p>
          <a href="{{ photo.url }}">{{ photo.url }}</a>
        </p>
      </div>
    </div>
    <img
      *ngIf="theEnd"
      class="d-flex mx-auto"
      src="assets/the-end.jpeg"
      width="480"
      height="352"
      alt="The End"
    />
  </cdk-virtual-scroll-viewport>
</ng-container>

<div *ngIf="this.isLoading" class="loader">
  <ng-container [ngTemplateOutlet]="loading"></ng-container>
</div>

<ng-template #loading>
  <!-- By Sam Herbert (@sherb), for everyone. More @ http://goo.gl/7AJzbL -->
  <svg
    class="mx-auto"
    width="120"
    height="30"
    viewBox="0 0 120 30"
    xmlns="http://www.w3.org/2000/svg"
    fill="#2196F3"
  >
    <circle cx="15" cy="15" r="15">
      <animate
        attributeName="r"
        from="15"
        to="15"
        begin="0s"
        dur="0.8s"
        values="15;9;15"
        calcMode="linear"
        repeatCount="indefinite"
      />
      <animate
        attributeName="fill-opacity"
        from="1"
        to="1"
        begin="0s"
        dur="0.8s"
        values="1;.5;1"
        calcMode="linear"
        repeatCount="indefinite"
      />
    </circle>
    <circle cx="60" cy="15" r="9" fill-opacity="0.3">
      <animate
        attributeName="r"
        from="9"
        to="9"
        begin="0s"
        dur="0.8s"
        values="9;15;9"
        calcMode="linear"
        repeatCount="indefinite"
      />
      <animate
        attributeName="fill-opacity"
        from="0.5"
        to="0.5"
        begin="0s"
        dur="0.8s"
        values=".5;1;.5"
        calcMode="linear"
        repeatCount="indefinite"
      />
    </circle>
    <circle cx="105" cy="15" r="15">
      <animate
        attributeName="r"
        from="15"
        to="15"
        begin="0s"
        dur="0.8s"
        values="15;9;15"
        calcMode="linear"
        repeatCount="indefinite"
      />
      <animate
        attributeName="fill-opacity"
        from="1"
        to="1"
        begin="0s"
        dur="0.8s"
        values="1;.5;1"
        calcMode="linear"
        repeatCount="indefinite"
      />
    </circle>
  </svg>
</ng-template>
